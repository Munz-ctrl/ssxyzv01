<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Try-On ‚Äî Sunsex</title>

  <!-- Base site styles -->
  <link rel="stylesheet" href="/shared/css/styles.css">
  <!-- Page styles (reuses DressUp styles + small overrides) -->
  <link rel="stylesheet" href="/apps/tryon/css/tryon.css">

    <!-- Cropper.js styles for cropping popup -->
  <link rel="stylesheet" href="https://unpkg.com/cropperjs@1.6.2/dist/cropper.min.css">

</head>
<body class="dressup-body">
  <div id="appContainer" class="app-container">

    <!-- Player / Brand Badge (can be brand or generic) -->
    <div id="currentPlayerInfo" class="player-info-badge">
      <span id="playerNameLabel">SUNSEX</span>
      <span id="playerIdLabel">#TRYON</span>
    </div>

    <!-- Skin selector (for future branded ‚Äúskins‚Äù / looks) -->
    <div id="skinSelector" class="skin-selector" style="display:none;">
      <span class="skin-label">Collection:</span>
      <select id="skinSelect">
        <option value="__base__">Default</option>
      </select>
    </div>

    <!-- Hidden canvas for watermark export -->
    <canvas id="downloadCanvas" style="display:none;"></canvas>

    
    <!-- HERO = USER PHOTO (person) -->
    <div
      id="hero"
      class="hero"
      data-default-hero="/shared/assets/fallbackIsoAvatar.webp">
    </div>

    <!-- CREDIT HUD (bottom-right) -->
    <div id="creditHUD" class="credit-hud">
      <div id="personalCreditPill" class="personal-pill">+0 credits</div>

      <div class="community-block">
        <div class="community-line">
          <span class="community-label">COMMUNITY</span>
          <span id="communityBarText" class="community-bar-text">[‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë] 0 left</span>
        </div>
      </div>
    </div>

    <!-- RIGHT PANEL: Try-On controls -->
    <aside class="panel" aria-label="Try-On controls">
      <div class="panel-card">

        <!-- Instruction copy (tuned for reversed flow) -->
        <div class="panel-instruction">
          <strong>&gt; STEP 1:</strong> Upload a clear photo of yourself. <br>
          <strong>&gt; STEP 2:</strong> Pick a piece from the collection. <br>
          <strong>&gt; STEP 3:</strong> Tap ‚ÄúTry On‚Äù.
        </div>

        <!-- There is one main preview for the SELECTED GARMENT -->
        <div class="thumb-wrap empty">
          <img id="garmentPreview" alt="">
        </div>
        <div class="panel-caption">SELECTED ITEM</div>

        <!-- Garment grid loaded from suitcaseItems.json (brand collection) -->
        <div id="garmentGrid" class="slot-row"></div>

        <!-- Actions -->
        <div class="panel-actions">
          <!-- Upload = USER PHOTO (person) -->
          <input id="fileInput" type="file" accept="image/*" hidden />
          <button id="btnUpload" class="btn primary">Upload Your Photo</button>
          <button id="btnGenerate" class="btn ghost" disabled>Try On Selected Item</button>
        </div>

        <!-- Thin secondary row: undo / download / reset -->
        <div class="panel-subactions">
          <button id="btnUndo" class="btn thin" style="display:none;">üîô</button>
          <button id="btnSave" class="btn thin" style="display:none;">download</button>
          <button id="btnResetHero" class="btn thin" style="display:none;">reset</button>
        </div>

        <div id="status" class="status" role="status" aria-live="polite"></div>
      </div>
    </aside>

    <!-- Animated watermark (bottom-left) -->
    <footer class="watermark animated-text" id="tryonWatermark">
      <div id="animatedWatermarkText"></div>
    </footer>
  </div>

  <!-- Cropping modal (popup) -->
  <div id="cropModal" class="crop-modal crop-hidden">
    <div class="crop-backdrop"></div>
    <div class="crop-dialog">
      <div class="crop-header">
        <span>Adjust your 9:16 crop</span>
      </div>
      <div class="crop-body">
        <div class="crop-image-wrap">
          <img id="cropImage" alt="Crop preview">
        </div>
      </div>
      <div class="crop-footer">
        <button id="cropCancelBtn" type="button" class="btn thin">cancel</button>
        <button id="cropConfirmBtn" type="button" class="btn primary">use this crop</button>
      </div>
    </div>
  </div>

  <!-- Supabase client -->
  <script type="module" src="/shared/js/supabase.js"></script>

  <!-- Cropper.js library -->
  <script src="https://unpkg.com/cropperjs@1.6.2/dist/cropper.min.js"></script>

  <!-- Try-On logic -->
  <script src="/apps/tryon/js/tryon.js"></script>

  <!-- Same watermark typography as DressUp -->
  <style>
   
    .animated-text {
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      font-size: 11px;
      line-height: 1.2;
      color: rgba(255,255,255,0.85);
      text-shadow: 0 1px 2px rgba(0,0,0,0.4);
      position: absolute;
      left: 2%;
      bottom: 2%;
      z-index: 3;
      text-align: left;
      white-space: pre-line;
      letter-spacing: 0.02em;
      width: auto;
      min-width: 120px;
      max-width: 220px;
      pointer-events: none;
      background: none;
      animation: none;
    }
  </style>
</body>
</html>
